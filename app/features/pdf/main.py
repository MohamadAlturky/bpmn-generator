from reportlab.lib.pagesizes import letter
from reportlab.lib.styles import getSampleStyleSheet
from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer
import json

def write_json_to_pdf(json_data, pdf_filename):
    # Create a PDF document
    doc = SimpleDocTemplate(pdf_filename, pagesize=letter)
    styles = getSampleStyleSheet()
    story = []

    # Iterate over JSON data
    for entry in json_data:
        role = entry.get("role", "Unknown Role").capitalize()
        content = entry.get("content", "")

        # Add role as a heading
        if role == "User":
          role = "First Agent"
          
        if role == "Assistant":
          role = "Second Agent"
        
        heading = Paragraph(f"<b>{role}:</b>", styles['Heading2'])
        story.append(heading)

        # Add content as a paragraph
        paragraph = Paragraph(content, styles['BodyText'])
        story.append(paragraph)

        # Add some space between entries
        story.append(Spacer(1, 12))

    # Build the PDF
    doc.build(story)

# Example JSON data
json_data = [
      {
        "role": "user",
        "content": "i am an expert in BPMN who wants to generate report which will be took by another team to generate a BPMN diagram for the following process description. \nwe will collaborate to generate this report.\n\n**Process description***\n\nConsider a process for purchasing items from an online shop. The user starts an order by logging in to their account. Then, the user simultaneously selects the items to purchase and sets a payment method. Afterward, the user either pays or completes an installment agreement. Since the reward value depends on the purchase value, After selecting the items, the user chooses between multiple options for a free reward. this step is done after selecting the items, but it is independent of the payment activities. Finally, the items are delivered. The user has the right to return items for exchange. Every time items are returned, a new delivery is made."
      },
      {
        "role": "assistant",
        "content": "As a BPMN expert, I'd be happy to help you generate a report that can be used to create a BPMN diagram for the described process.\n\nLet's break down the process description into its key elements and identify the main steps, gateways, and activities that will be required in the BPMN diagram.\n\n**Main Steps:**\n\n1. Login to account\n2. Select items to purchase and set payment method (parallel activities)\n3. Choose free reward (dependent on purchase value, independent of payment activities)\n4. Pay or complete installment agreement\n5. Deliver items\n6. Return items for exchange (optional)\n7. New delivery (optional)\n\n**Gateways:**\n\n1. Decision gateway: User decides to pay or complete installment agreement\n2. Decision gateway: User decides to return items for exchange\n\n**Activities:**\n\n1. Login to account\n2. Select items to purchase\n3. Set payment method\n4. Choose free reward\n5. Pay\n6. Complete installment agreement\n7. Deliver items\n8. Return items for exchange\n9. New delivery\n\n**Parallel Activities:**\n\n1. Select items to purchase and set payment method (these two activities happen simultaneously)\n\n**Dependencies:**\n\n1. The choice of free reward depends on the purchase value\n2. The payment activities (pay or complete installment agreement) are independent of the reward selection\n3. The delivery of items is dependent on the completion of the payment activities\n4. The return of items for exchange is an optional step that can occur after delivery\n5. The new delivery is dependent on the return of items for exchange\n\nThis is a good starting point for creating a report that can be used to generate a BPMN diagram. What would you like to add or modify in this report before proceeding?"
      },
      {
        "role": "user",
        "content": "Your breakdown is excellent. You have successfully identified the main steps, gateways, activities, parallel activities, and dependencies in the process description.\n\nI would like to add a few more details to make the report more comprehensive. Let's consider the following:\n\n**Inputs and Outputs:**\n\nFor each activity, let's identify the inputs and outputs that will help clarify the process. For example:\n\n* Login to account:\n\t+ Input: User credentials\n\t+ Output: Successful login\n* Select items to purchase:\n\t+ Input: Available items\n\t+ Output: Selected items\n* Set payment method:\n\t+ Input: Available payment options\n\t+ Output: Chosen payment method\n* And so on...\n\n**Lane Assignments:**\n\nLet's identify the lanes or swimlanes that will be required in the BPMN diagram to organize the activities. For example:\n\n* User (customer)\n* Online Shop (system)\n* Payment Gateway (system)\n\nBy assigning activities to specific lanes, we can better visualize the process and identify the roles and responsibilities of each participant.\n\n**Additional Notes:**\n\nLet's add any additional notes or comments that might be useful for the team generating the BPMN diagram. For example:\n\n* The process assumes that the user has already registered with the online shop.\n* The payment gateway may have additional steps or validation requirements that are not shown in this process.\n* The return and exchange process may have specific business rules or limitations that need to be considered.\n\nBy including these additional details, we can create a comprehensive report that will help the team generate an accurate and informative BPMN diagram.\n\nWhat do you think? Are there any other aspects we should consider adding to the report?"
      },
      {
        "role": "assistant",
        "content": "I completely agree with your suggestions. Adding inputs and outputs, lane assignments, and additional notes will make the report more comprehensive and detailed, which will ultimately help the team generating the BPMN diagram to create a more accurate and informative diagram.\n\nLet's start with the inputs and outputs for each activity:\n\n**Inputs and Outputs:**\n\n* Login to account:\n\t+ Input: User credentials\n\t+ Output: Successful login\n* Select items to purchase:\n\t+ Input: Available items, user's purchase history\n\t+ Output: Selected items\n* Set payment method:\n\t+ Input: Available payment options, user's payment history\n\t+ Output: Chosen payment method\n* Choose free reward:\n\t+ Input: Selected items, reward options\n\t+ Output: Chosen reward\n* Pay:\n\t+ Input: Chosen payment method, payment details\n\t+ Output: Payment confirmation\n* Complete installment agreement:\n\t+ Input: Chosen payment method, payment plan\n\t+ Output: Installment agreement confirmation\n* Deliver items:\n\t+ Input: Payment confirmation, delivery details\n\t+ Output: Delivered items\n* Return items for exchange:\n\t+ Input: Delivered items, return reason\n\t+ Output: Returned items\n* New delivery:\n\t+ Input: Returned items, new delivery details\n\t+ Output: New delivered items\n\nNext, let's identify the lanes or swimlanes required for the BPMN diagram:\n\n**Lane Assignments:**\n\n* User (customer): Login to account, Select items to purchase, Choose free reward, Return items for exchange\n* Online Shop (system): Set payment method, Deliver items, New delivery\n* Payment Gateway (system): Pay, Complete installment agreement\n\nFinally, let's add some additional notes to clarify the process:\n\n**Additional Notes:**\n\n* The process assumes that the user has already registered with the online shop and has a valid account.\n* The payment gateway may have additional steps or validation requirements that are not shown in this process.\n* The return and exchange process may have specific business rules or limitations that need to be considered, such as a time limit for returns or restrictions on certain items.\n* The online shop may have different delivery options, such as standard or express shipping, which could affect the delivery process.\n\nBy including these additional details, we can provide a comprehensive report that will help the team generating the BPMN diagram to create a more accurate and informative diagram.\n\nWhat do you think? Have we covered all the essential aspects, or is there anything else we should consider adding to the report?"
      },
      {
        "role": "user",
        "content": "Excellent work! I think we've covered all the essential aspects of the process. The inputs and outputs for each activity are well-defined, and the lane assignments are clear and logical. The additional notes provide useful context and clarification for the process.\n\nI especially like how you've included specific details, such as the user's purchase history and payment history, as inputs to certain activities. This will help the team generating the BPMN diagram to create a more accurate and detailed representation of the process.\n\nOne minor suggestion I have is to consider adding a brief description or summary of each activity, in addition to the inputs and outputs. This could provide further context and clarity for the team generating the BPMN diagram.\n\nFor example:\n\n* Login to account:\n\t+ Input: User credentials\n\t+ Output: Successful login\n\t+ Description: The user logs in to their account using their credentials.\n* Select items to purchase:\n\t+ Input: Available items, user's purchase history\n\t+ Output: Selected items\n\t+ Description: The user browses the online shop and selects the items they wish to purchase.\n\nThis is just a minor suggestion, but I think it could help to further clarify the process and ensure that the BPMN diagram accurately represents the activities and flows.\n\nOverall, I think we've created a comprehensive and detailed report that will provide a solid foundation for the team generating the BPMN diagram. Well done!This was the last message in our conversation, now you can write the final report."
      },
      {
        "role": "assistant",
        "content": "**Final Report: Process Description for Online Shop Purchase**\n\n**Main Steps:**\n\n1. Login to account\n2. Select items to purchase and set payment method (parallel activities)\n3. Choose free reward (dependent on purchase value, independent of payment activities)\n4. Pay or complete installment agreement\n5. Deliver items\n6. Return items for exchange (optional)\n7. New delivery (optional)\n\n**Gateways:**\n\n1. Decision gateway: User decides to pay or complete installment agreement\n2. Decision gateway: User decides to return items for exchange\n\n**Activities:**\n\n1. Login to account\n\t* Input: User credentials\n\t* Output: Successful login\n\t* Description: The user logs in to their account using their credentials.\n2. Select items to purchase\n\t* Input: Available items, user's purchase history\n\t* Output: Selected items\n\t* Description: The user browses the online shop and selects the items they wish to purchase.\n3. Set payment method\n\t* Input: Available payment options, user's payment history\n\t* Output: Chosen payment method\n\t* Description: The user selects a payment method from the available options.\n4. Choose free reward\n\t* Input: Selected items, reward options\n\t* Output: Chosen reward\n\t* Description: The user selects a free reward based on the purchase value.\n5. Pay\n\t* Input: Chosen payment method, payment details\n\t* Output: Payment confirmation\n\t* Description: The user completes the payment using the chosen payment method.\n6. Complete installment agreement\n\t* Input: Chosen payment method, payment plan\n\t* Output: Installment agreement confirmation\n\t* Description: The user completes the installment agreement and sets up a payment plan.\n7. Deliver items\n\t* Input: Payment confirmation, delivery details\n\t* Output: Delivered items\n\t* Description: The online shop delivers the purchased items to the user.\n8. Return items for exchange\n\t* Input: Delivered items, return reason\n\t* Output: Returned items\n\t* Description: The user returns items for exchange, providing a reason for the return.\n9. New delivery\n\t* Input: Returned items, new delivery details\n\t* Output: New delivered items\n\t* Description: The online shop delivers new items to the user as a replacement for the returned items.\n\n**Lane Assignments:**\n\n* User (customer): Login to account, Select items to purchase, Choose free reward, Return items for exchange\n* Online Shop (system): Set payment method, Deliver items, New delivery\n* Payment Gateway (system): Pay, Complete installment agreement\n\n**Additional Notes:**\n\n* The process assumes that the user has already registered with the online shop and has a valid account.\n* The payment gateway may have additional steps or validation requirements that are not shown in this process.\n* The return and exchange process may have specific business rules or limitations that need to be considered, such as a time limit for returns or restrictions on certain items.\n* The online shop may have different delivery options, such as standard or express shipping, which could affect the delivery process.\n\nThis report provides a comprehensive description of the online shop purchase process, including main steps, gateways, activities, inputs, outputs, and descriptions for each activity. The lane assignments and additional notes provide further context and clarity for the process."
      }
    ]

# Convert JSON data to PDF
write_json_to_pdf(json_data, "output.pdf")